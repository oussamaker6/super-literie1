<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€” Super Literie</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body{margin:0;font-family:"Cairo",sans-serif;background:#f5f5f5;color:#111}
  .login,.panel{max-width:800px;margin:40px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 5px 20px rgba(0,0,0,0.1)}
  h1,h2{color:#174b74}
  input,textarea,select{width:100%;padding:10px;margin:6px 0;border:1px solid #ddd;border-radius:8px;font-family:"Cairo"}
  button{background:#174b74;color:#fff;padding:10px 16px;border:0;border-radius:8px;cursor:pointer;font-weight:700}
  .product{padding:10px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}
  .hidden{display:none}
  .row{display:flex;gap:10px}
  .row input{flex:1}
</style>
</head>
<body>

<div class="login" id="loginBox">
  <h1>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h1>
  <input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
  <button onclick="checkPass()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div class="panel hidden" id="adminPanel">
  <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>

  <h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±</h2>
  <label>Ø®Ù„ÙÙŠØ© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</label>
  <input type="file" id="bgFile">
  <label>Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¬Ø± (Ù„ÙˆØºÙˆ)</label>
  <input type="file" id="logoFile">
  <button onclick="saveSettings()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>

  <h2>Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬</h2>
  <input id="pTitle" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
  <input id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
  <textarea id="pDesc" placeholder="Ø§Ù„ÙˆØµÙ"></textarea>
  <label>ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬</label>
  <input type="file" id="pImgs" multiple>
  
  <label>Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨ÙØ§ØµÙ„Ø©)</label>
  <input id="pSizes" placeholder="Ù…Ø«Ø§Ù„: S,M,L,XL">
  
  <label>Ø§Ù„Ø£Ù„ÙˆØ§Ù† (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø§ÙØµÙ„ Ø¨ÙŠÙ†Ù‡Ø§ Ø¨ÙØ§ØµÙ„Ø©)</label>
  <input id="pColors" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­Ù…Ø±,Ø£Ø²Ø±Ù‚,Ø£Ø®Ø¶Ø±">
  
  <button onclick="addProduct()">â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>

  <h2>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
  <div id="productList"></div>
</div>

<script type="module">
  // ===== Firebase =====
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const storage = getStorage(app);

  // ===== ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø¨Ø³ÙŠØ·Ø© =====
  const ADMIN_PASSWORD = "123456"; // ğŸ”‘ ØºÙŠØ±Ù‡Ø§ Ø¨Ù…Ø§ ØªØ±ÙŠØ¯

  window.checkPass = function(){
    const val = document.getElementById("adminPass").value;
    if(val === ADMIN_PASSWORD){
      document.getElementById("loginBox").classList.add("hidden");
      document.getElementById("adminPanel").classList.remove("hidden");
      loadProducts();
    } else {
      alert("âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø©");
    }
  }

  // ===== Ø±ÙØ¹ Ù…Ù„Ù (Ø®Ù„ÙÙŠØ©/Ù„ÙˆØºÙˆ/ØµÙˆØ±) =====
  async function uploadFile(file, folder){
    const fileRef = ref(storage, folder + "/" + Date.now() + "_" + file.name);
    await uploadBytes(fileRef, file);
    return await getDownloadURL(fileRef);
  }

  // ===== Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª =====
  window.saveSettings = async function(){
    let bgUrl="", logoUrl="";
    const bgFile = document.getElementById("bgFile").files[0];
    const logoFile = document.getElementById("logoFile").files[0];
    if(bgFile) bgUrl = await uploadFile(bgFile,"settings");
    if(logoFile) logoUrl = await uploadFile(logoFile,"settings");

    await setDoc(doc(db,"settings","main"), {background:bgUrl,logo:logoUrl});
    alert("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª");
  }

  // ===== Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ =====
  window.addProduct = async function(){
    const title = document.getElementById("pTitle").value;
    const price = Number(document.getElementById("pPrice").value);
    const desc = document.getElementById("pDesc").value;
    const sizes = document.getElementById("pSizes").value.split(",").map(s=>s.trim()).filter(Boolean);
    const colors = document.getElementById("pColors").value.split(",").map(c=>c.trim()).filter(Boolean);

    let imgs=[];
    const files = document.getElementById("pImgs").files;
    for(let f of files){
      const url = await uploadFile(f,"products");
      imgs.push(url);
    }

    await addDoc(collection(db,"products"), {title,price,desc,img:imgs,sizes,colors});
    alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬");
    loadProducts();
  }

  // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª =====
  async function loadProducts(){
    const snap = await getDocs(collection(db,"products"));
    let html="";
    snap.forEach(d=>{
      const p = d.data();
      html+=`<div class="product">
        <div>${p.title} - ${p.price} Ø¯Ø¬</div>
        <button onclick="deleteProduct('${d.id}')">ğŸ—‘ï¸ Ø­Ø°Ù</button>
      </div>`;
    });
    document.getElementById("productList").innerHTML = html;
  }

  // ===== Ø­Ø°Ù Ù…Ù†ØªØ¬ =====
  window.deleteProduct = async function(id){
    await deleteDoc(doc(db,"products",id));
    alert("ğŸ—‘ï¸ ØªÙ… Ø§Ù„Ø­Ø°Ù");
    loadProducts();
  }
</script>

</body>
</html>