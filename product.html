<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>تفاصيل المنتج — Super Literie</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root { --primary:#174b74 }
  body { margin:0; font-family:"Cairo",sans-serif; background:#fff; color:#111 }
  header { text-align:center; padding:12px; border-bottom:1px solid #eee }
  header img { width:150px }
  .container { max-width:1000px; margin:20px auto; padding:15px }
  .product { display:flex; flex-wrap:wrap; gap:20px; }
  .product img { flex:1; max-width:400px; border-radius:10px; object-fit:cover }
  .details { flex:2; min-width:280px }
  h1 { color:var(--primary); margin:10px 0 }
  .price { font-size:20px; font-weight:700; color:var(--primary); margin:10px 0 }
  form { margin-top:20px; background:#f9f9f9; padding:15px; border-radius:10px }
  form label { display:block; margin:10px 0 5px }
  form select, form input, form button { width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; font-family:inherit }
  form button { background:var(--primary); color:#fff; border:none; margin-top:15px; cursor:pointer }
  footer { text-align:center; padding:15px; color:#666; margin-top:30px; border-top:1px solid #eee }
</style>
</head>
<body>

<header>
  <img src="assets/logo.png" alt="Super Literie">
</header>

<main class="container">
  <div class="product">
    <img id="prodImg" src="" alt="المنتج">
    <div class="details">
      <h1 id="prodTitle">...</h1>
      <div class="price" id="prodPrice"></div>
      <p id="prodDesc"></p>

      <form id="orderForm">
        <h3>اطلب الآن</h3>
        <label>الاسم الكامل:</label>
        <input type="text" id="fullname" required>

        <label>رقم الهاتف:</label>
        <input type="tel" id="phone" required>

        <label>الولاية:</label>
        <select id="wilaya" required>
          <option value="">اختر ولايتك</option>
        </select>

        <label>البلدية:</label>
        <select id="baladia" required>
          <option value="">اختر البلدية</option>
        </select>

        <button type="submit">تأكيد الطلب</button>
      </form>
    </div>
  </div>
</main>

<footer>
  تواصل معنا عبر واتساب: +213666707587
</footer>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAj8Dp9Rp98knthETTEBMx22KwICPy5x-8",
    authDomain: "super-literiee.firebaseapp.com",
    projectId: "super-literiee",
    storageBucket: "super-literiee.appspot.com",
    messagingSenderId: "829189351259",
    appId: "1:829189351259:web:0426969718d46132c19c7e",
    measurementId: "G-0KBQFEK6KH"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // الحصول على ID من الرابط
  const urlParams = new URLSearchParams(window.location.search);
  const prodId = urlParams.get("id");

  async function loadProduct() {
    if (!prodId) return;
    const ref = doc(db, "products", prodId);
    const snap = await getDoc(ref);
    if (snap.exists()) {
      const p = snap.data();
      document.getElementById("prodImg").src = p.img;
      document.getElementById("prodTitle").textContent = p.title;
      document.getElementById("prodPrice").textContent = p.price + " دج";
      document.getElementById("prodDesc").textContent = p.desc || "";
    } else {
      document.querySelector(".container").innerHTML = "<p>❌ المنتج غير موجود.</p>";
    }
  }
  loadProduct();

  // قائمة الولايات الجزائرية
  const wilayas = [
    "أدرار","الشلف","الأغواط","أم البواقي","باتنة","بجاية","بسكرة","بشار","البليدة",
    "البويرة","تمنراست","تبسة","تلمسان","تيارت","تيزي وزو","الجزائر","الجلفة","جيجل",
    "سطيف","سعيدة","سكيكدة","سيدي بلعباس","عنابة","قالمة","قسنطينة","المدية","مستغانم",
    "المسيلة","معسكر","ورقلة","وهران","البيض","إليزي","برج بوعريريج","بومرداس","الطارف",
    "تندوف","تيسمسيلت","الوادي","خنشلة","سوق أهراس","تيبازة","ميلة","عين الدفلى","النعامة",
    "عين تموشنت","غرداية","غليزان","تيميمون","برج باجي مختار","أولاد جلال","بني عباس",
    "عين صالح","عين قزام","تقرت","جانت","المغير","المنيعة"
  ];

  const baladiat = {
    "الجزائر": ["الجزائر الوسطى","باب الواد","الحراش","الكاليتوس"],
    "وهران": ["وهران","السانية","أرزيو","قديل"],
    "سطيف": ["سطيف","العلمة","عين ولمان","بوقاعة"],
    "عنابة": ["عنابة","الحجار","سيدي عمار","برحال"],
    // ... نكمل باقي البلديات بملف JSON خارجي فيما بعد
  };

  const wilayaSelect = document.getElementById("wilaya");
  const baladiaSelect = document.getElementById("baladia");

  wilayas.forEach(w => {
    const opt = document.createElement("option");
    opt.value = w;
    opt.textContent = w;
    wilayaSelect.appendChild(opt);
  });

  wilayaSelect.addEventListener("change", () => {
    const w = wilayaSelect.value;
    baladiaSelect.innerHTML = "";
    if (baladiat[w]) {
      baladiat[w].forEach(b => {
        const opt = document.createElement("option");
        opt.value = b;
        opt.textContent = b;
        baladiaSelect.appendChild(opt);
      });
    } else {
      const opt = document.createElement("option");
      opt.value = "";
      opt.textContent = "اختر الولاية أولاً";
      baladiaSelect.appendChild(opt);
    }
  });
</script>

</body>
</html>